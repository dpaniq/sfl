@if (loading()) {
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
}

<table
  mat-table
  matSort
  [dataSource]="dataSource"
  class="mat-elevation-z1"
>
  <!--- Note that these columns can be defined in any order.
        The actual rendered columns are set as a property on the row definition" -->

  <!-- Avatar Column -->
  <ng-container matColumnDef="avatar">
    <th
      mat-header-cell
      *matHeaderCellDef
    ></th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      <!-- <img
        class="avatar"
        src="https://picsum.photos/id/{{ element.avatar }}/50/50"
      /> -->
    </td>
  </ng-container>

  <!-- Number Column -->
  <ng-container matColumnDef="number">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by number"
    >
      #
    </th>
    <td
      mat-cell
      *matCellDef="let element"
      [innerHtml]="element.number | nilToDash"
    ></td>
  </ng-container>

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by name"
    >
      Name
    </th>
    <td
      mat-cell
      *matCellDef="let element"
      [innerHtml]="element.name | nilToDash"
    ></td>
  </ng-container>

  <!-- Surname Column -->
  <ng-container matColumnDef="surname">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by surname"
    >
      Surname
    </th>
    <td
      mat-cell
      *matCellDef="let element"
      [innerHtml]="element.surname | nilToDash"
    ></td>
  </ng-container>

  <!-- Nickname Column -->
  <ng-container matColumnDef="nickname">
    <th
      mat-header-cell
      mat-sort-header
      *matHeaderCellDef
      sortActionDescription="Sort by nickname"
    >
      Nickname
    </th>
    <td
      mat-cell
      *matCellDef="let element"
      [innerHtml]="element.nickname | nilToDash"
    ></td>
  </ng-container>

  <!-- Is Captain Column -->
  <ng-container matColumnDef="isCaptain">
    <th
      mat-header-cell
      mat-sort-header
      *matHeaderCellDef
      sortActionDescription="Sort by captain"
    >
      Is Captain
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      @if (element.isCaptain) {
        <mat-icon fontIcon="check"></mat-icon>
      }
    </td>
  </ng-container>

  <!-- Total Games Column -->
  <ng-container matColumnDef="totalGames">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by total games"
    >
      Total games
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      {{ element.totalGames }}
    </td>
  </ng-container>

  <!-- Won Games Column -->
  <ng-container matColumnDef="wonGames">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by won games"
    >
      Won games
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      {{ element.wonGames }}
    </td>
  </ng-container>

  <!-- Lost Games Column -->
  <ng-container matColumnDef="lostGames">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by lost games"
    >
      Lost games
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      {{ element.lostGames }}
    </td>
  </ng-container>

  <!-- Draws Column -->
  <ng-container matColumnDef="draws">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by draws"
    >
      Draws
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      {{ element.draws }}
    </td>
  </ng-container>

  <!-- Max Win Streak Column -->
  <ng-container matColumnDef="maxWinStreak">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by max win streak"
    >
      Max win streak
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      {{ element.maxWinStreak }}
    </td>
  </ng-container>

  <!-- Max Lost Streak Column -->
  <ng-container matColumnDef="maxLostStreak">
    <th
      mat-header-cell
      *matHeaderCellDef
      mat-sort-header
      sortActionDescription="Sort by max lost streak"
    >
      Max lost streak
    </th>
    <td
      mat-cell
      *matCellDef="let element"
    >
      {{ element.maxLostStreak }}
    </td>
  </ng-container>

  <!--Actions Column -->
  <ng-container matColumnDef="actions">
    <th
      mat-header-cell
      *matHeaderCellDef
    ></th>

    <td
      mat-cell
      *matCellDef="let element"
    >
      <button
        mat-icon-button
        color="primary"
        [disabled]="!element.id"
        (click)="openPlayerDetailsPage(element.id)"
      >
        <mat-icon fontIcon="read_more"></mat-icon>
      </button>

      @if (isAdminSignal()) {
        <button
          mat-icon-button
          [disabled]="false && !user?.roles?.includes('ADMIN')"
          color="primary"
          (click)="editPlayer(element)"
        >
          <mat-icon fontIcon="edit"></mat-icon>
        </button>

        <button
          mat-icon-button
          [disabled]="false && !user?.roles?.includes('ADMIN')"
          color="primary"
          (click)="deletePlayer(element)"
        >
          <mat-icon
            color="warn"
            fontIcon="delete"
          ></mat-icon>
        </button>
      }
    </td>
  </ng-container>

  <tr
    mat-header-row
    *matHeaderRowDef="displayedColumns; sticky: true"
  ></tr>

  <tr
    mat-row
    *matRowDef="let row; columns: displayedColumns"
  ></tr>
</table>
